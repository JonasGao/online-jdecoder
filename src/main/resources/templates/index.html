<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>JDecoder</title>
    <link href="/static/bootstrap.min.css" rel="stylesheet"/>
    <style>
        #javaInstallSelect,
        #mainClass,
        #javaCode {
            font-family: monospace;
        }

        #editor {
            width: 100%;
            height: 50vh;
        }
    </style>
</head>
<body>
<div class="container">
    <header class="d-flex flex-wrap justify-content-center py-3 mb-4 border-bottom">
        <a href="/" class="d-flex align-items-center mb-3 mb-md-0 me-md-auto link-body-emphasis text-decoration-none">
            <svg xmlns="http://www.w3.org/2000/svg" width="30" height="20" fill="currentColor"
                 class="bi bi-cup-hot-fill" viewBox="0 0 16 16">
                <path fill-rule="evenodd"
                      d="M.5 6a.5.5 0 0 0-.488.608l1.652 7.434A2.5 2.5 0 0 0 4.104 16h5.792a2.5 2.5 0 0 0 2.44-1.958l.131-.59a3 3 0 0 0 1.3-5.854l.221-.99A.5.5 0 0 0 13.5 6H.5ZM13 12.5a2.01 2.01 0 0 1-.316-.025l.867-3.898A2.001 2.001 0 0 1 13 12.5Z"/>
                <path d="m4.4.8-.003.004-.014.019a4.167 4.167 0 0 0-.204.31 2.327 2.327 0 0 0-.141.267c-.026.06-.034.092-.037.103v.004a.593.593 0 0 0 .091.248c.075.133.178.272.308.445l.01.012c.118.158.26.347.37.543.112.2.22.455.22.745 0 .188-.065.368-.119.494a3.31 3.31 0 0 1-.202.388 5.444 5.444 0 0 1-.253.382l-.018.025-.005.008-.002.002A.5.5 0 0 1 3.6 4.2l.003-.004.014-.019a4.149 4.149 0 0 0 .204-.31 2.06 2.06 0 0 0 .141-.267c.026-.06.034-.092.037-.103a.593.593 0 0 0-.09-.252A4.334 4.334 0 0 0 3.6 2.8l-.01-.012a5.099 5.099 0 0 1-.37-.543A1.53 1.53 0 0 1 3 1.5c0-.188.065-.368.119-.494.059-.138.134-.274.202-.388a5.446 5.446 0 0 1 .253-.382l.025-.035A.5.5 0 0 1 4.4.8Zm3 0-.003.004-.014.019a4.167 4.167 0 0 0-.204.31 2.327 2.327 0 0 0-.141.267c-.026.06-.034.092-.037.103v.004a.593.593 0 0 0 .091.248c.075.133.178.272.308.445l.01.012c.118.158.26.347.37.543.112.2.22.455.22.745 0 .188-.065.368-.119.494a3.31 3.31 0 0 1-.202.388 5.444 5.444 0 0 1-.253.382l-.018.025-.005.008-.002.002A.5.5 0 0 1 6.6 4.2l.003-.004.014-.019a4.149 4.149 0 0 0 .204-.31 2.06 2.06 0 0 0 .141-.267c.026-.06.034-.092.037-.103a.593.593 0 0 0-.09-.252A4.334 4.334 0 0 0 6.6 2.8l-.01-.012a5.099 5.099 0 0 1-.37-.543A1.53 1.53 0 0 1 6 1.5c0-.188.065-.368.119-.494.059-.138.134-.274.202-.388a5.446 5.446 0 0 1 .253-.382l.025-.035A.5.5 0 0 1 7.4.8Zm3 0-.003.004-.014.019a4.077 4.077 0 0 0-.204.31 2.337 2.337 0 0 0-.141.267c-.026.06-.034.092-.037.103v.004a.593.593 0 0 0 .091.248c.075.133.178.272.308.445l.01.012c.118.158.26.347.37.543.112.2.22.455.22.745 0 .188-.065.368-.119.494a3.198 3.198 0 0 1-.202.388 5.385 5.385 0 0 1-.252.382l-.019.025-.005.008-.002.002A.5.5 0 0 1 9.6 4.2l.003-.004.014-.019a4.149 4.149 0 0 0 .204-.31 2.06 2.06 0 0 0 .141-.267c.026-.06.034-.092.037-.103a.593.593 0 0 0-.09-.252A4.334 4.334 0 0 0 9.6 2.8l-.01-.012a5.099 5.099 0 0 1-.37-.543A1.53 1.53 0 0 1 9 1.5c0-.188.065-.368.119-.494.059-.138.134-.274.202-.388a5.446 5.446 0 0 1 .253-.382l.025-.035A.5.5 0 0 1 10.4.8Z"/>
            </svg>
            <span class="fs-6">JDecoder</span>
        </a>
    </header>
    <form action="/compile" method="post" name="compile">
        <div class="mb-3">
            <label for="javaInstallSelect" class="form-label">Java Installation</label>
            <select class="form-select" aria-label="Java Install Select" id="javaInstallSelect"
                    name="javaInstallSelect">
                <option th:each="ins:${javaInstalls}" th:value="${ins.key()}" th:text="${ins.fullName()}"></option>
            </select>
        </div>
        <div class="mb-3 form-check">
            <input class="form-check-input" type="checkbox" value="true" id="verbose" name="verbose">
            <label class="form-check-label" for="verbose">
                Disassembles Verbose
            </label>
        </div>
        <div class="mb-3">
            <label for="mainClass" class="form-label">Main Class</label>
            <input type="text" class="form-control" id="mainClass" name="mainClass">
        </div>
        <div class="mb-3">
            <label for="javaCode" class="form-label">Java Code</label>
            <textarea class="form-control" id="javaCode" name="javaCode" rows="18" hidden="hidden"></textarea>
            <div id="editor"></div>
        </div>
        <button type="submit" class="btn btn-primary" onclick="saveForm()">Submit</button>
    </form>
</div>
<script src="/static/bootstrap.bundle.min.js"></script>
<script src="/static/ace.js" type="text/javascript" charset="utf-8"></script>
<script>
  const editor = ace.edit("editor", {
    mode: "ace/mode/java",
    selectionStyle: "text"
  });
  editor.setTheme("ace/theme/monokai");

  window.addEventListener("load", () => {
    let form = document.forms["compile"];
    form.javaInstallSelect.value = localStorage.getItem("form_javaInstallSelect_value");
    form.verbose.checked = localStorage.getItem("form_verbose_value") === "true";
    form.mainClass.value = localStorage.getItem("form_mainClass_value");
    form.javaCode.value = localStorage.getItem("form_javaCode_value");
    editor.setValue(form.javaCode.value);
  })

  function saveForm() {
    let form = document.forms["compile"];
    localStorage.setItem("form_javaInstallSelect_value", form.javaInstallSelect.value);
    localStorage.setItem("form_verbose_value", form.verbose.checked);
    localStorage.setItem("form_mainClass_value", form.mainClass.value);
    form.javaCode.value = editor.getValue();
    localStorage.setItem("form_javaCode_value", form.javaCode.value);
  }
</script>
</body>
</html>
